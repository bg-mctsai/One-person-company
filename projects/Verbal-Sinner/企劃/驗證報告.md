# Moment Configs 驗證報告

> 生成時間：2024-12-19  
> 目的：手動驗證所有 14 個 moment-configs 文件的完整性和正確性。

---

## 驗證結果總覽

### ✅ 文件完整性

- [x] 所有 14 個 moment-configs 文件存在
- [x] 每個文件的 JSON 格式正確
- [x] 每個文件的 `momentId` 與文件名對應

### ⚠️ 發現的問題

#### 1. Moment Spec 表對應（已統一）

| 時刻 | 項目 | 實際值 | Moment Spec 表 | 狀態 |
|------|------|--------|----------------|------|
| 1 | target | `尊重` | `尊重` | ✅ |
| 1 | date | `2019/01/10` | `2019/01/10` | ✅ |
| 2 | target | `認同` | `認同` | ✅ 已統一 |
| 2 | date | `2019/02/15` | `2019/02/15` | ✅ |
| 3 | date | `2019/03/20` | `2019/03/20` | ✅ |
| 5 | date | `2019/06/20` | `2019/06/20` | ✅ |
| 5 | title | `情人的承諾` | `情人的承諾` | ✅ |

**說明**：
- ✅ 時刻 2 的 `target` 已確認為 `認同`，並已更新 Moment Spec 表。

#### 2. maxTurns 與 rounds 數量檢查

| 時刻 | maxTurns | rounds 數量 | 狀態 |
|------|----------|-------------|------|
| 1 | 3 | 3 | ✅ |
| 2 | 3 | 3 | ✅ |
| 3 | 3 | 3 | ✅ |
| 4 | 3 | 3 | ✅ |
| 5 | 4 | 4 | ✅ |
| 6 | 5 | 5 | ✅ |
| 7 | 5 | 5 | ✅ |
| 8 | 5 | 5 | ✅ |
| 9 | 5 | 5 | ✅ |
| 10 | 6 | 6 | ✅ |
| 11 | 7 | 7 | ✅ |
| 12 | 7 | 7 | ✅ |
| 13 | 7 | 7 | ✅ |
| 14 | 8 | 8 | ✅ |

**結果**：所有時刻的 `maxTurns` 與 `rounds` 數量一致 ✅

#### 3. 選項數量檢查

所有時刻的每個 round 都有至少 3 個選項 ✅

#### 4. 選項類型檢查

所有選項的 `optionType` 都是有效的（積極對抗/溫和堅持/情感訴求/順從消極）✅

#### 5. Tags 檢查

所有選項都有 `tags` 且至少包含 1 個標籤 ✅

#### 6. 禁用詞檢查

手動檢查前 3 個時刻，未發現禁用詞（遊戲、關卡、玩家、挑戰、UI）✅

#### 7. supportInterjections 檢查

| 時刻 | supportInterjections | templateKey | 狀態 |
|------|---------------------|-------------|------|
| 1 | ✅ | `interject.watch.1` | ✅ 已定義 |
| 3 | ✅ | `interject.rumor.1` | ✅ 已定義 |
| 6 | ✅ | `interject.collusion.1` | ✅ 已定義 |
| 7 | ✅ | `interject.threatened.1` | ✅ 已定義 |
| 8 | ✅ | `interject.know.2` | ✅ 已定義 |
| 11 | ✅ | `interject.know.1`, `interject.threatened.2` | ✅ 已定義 |
| 12 | ✅ | `interject.threatened.3` | ✅ 已定義 |
| 13 | ✅ | `interject.rumor.2` | ✅ 已定義 |

**結果**：所有使用的 `templateKey` 都在 `插話模板庫.md` 中定義 ✅

---

## 需要補強的部分

### 1. 時刻 2 的 target 不一致

**問題**：moment-02.json 中的 `target` 是 `認同`，但 Moment Spec 表中是 `尊重`。

**建議**：
- 如果 `認同` 是正確的，需要更新 Moment Spec 表
- 如果 `尊重` 是正確的，需要更新 moment-02.json

### 2. 缺少 clueId 欄位

**問題**：所有 moment-configs 文件中都沒有 `clueId` 欄位。

**建議**：
- 根據 Moment Spec 表，每個時刻都應該有對應的 `clueId`（CLUE-01 ~ CLUE-14）
- 需要在每個 moment-config 中添加 `clueId` 欄位

### 3. 缺少 seedMap 欄位

**問題**：所有 moment-configs 文件中都沒有 `seedMap` 欄位。

**建議**：
- 根據 Moment Spec 表，每個時刻都應該有對應的 `seedMap`
- 需要在每個 moment-config 中添加 `seedMap` 欄位（用於金手指提示庫）

### 4. 缺少 entryOverrides 欄位

**問題**：所有 moment-configs 文件中都沒有 `entryOverrides` 欄位。

**建議**：
- 根據 Moment Spec 表，部分時刻應該有 `entryOverrides`（入幕屬性修正）
- 需要在對應的 moment-config 中添加 `entryOverrides` 欄位

---

## 補強建議

### 優先級 P0（必須補強）

1. ✅ **添加 clueId 欄位**：所有 14 個時刻都需要添加 `clueId` - **已完成**
2. ✅ **修正時刻 2 的 target**：確認是 `認同` 還是 `尊重`，並統一 - **已完成**（已確認為 `認同`）

### 優先級 P1（建議補強）

3. **添加 seedMap 欄位**：所有 14 個時刻都需要添加 `seedMap`
4. **添加 entryOverrides 欄位**：根據 Moment Spec 表添加對應的 `entryOverrides`

---

## 驗證腳本使用說明

已建立驗證腳本：`scripts/validate-moments.js`

**執行方式**（在項目根目錄）：
```bash
node 企劃/scripts/validate-moments.js
```

**功能**：
- 檢查所有 14 個 moment-configs 文件是否存在
- 驗證 JSON 格式正確性
- 檢查 `maxTurns` 與 `rounds` 數量一致
- 檢查每個 round 至少有 3 個選項
- 檢查選項類型、tags、禁用詞
- 檢查與 Moment Spec 表的對應關係
- 檢查 `supportInterjections` 的 `templateKey` 是否在插話模板庫中定義

---

## 下一步行動

1. ✅ 已完成：建立驗證腳本
2. ✅ 已完成：修正時刻 2 的 target 不一致問題（已確認為 `認同`）
3. ✅ 已完成：為所有 moment-configs 添加 `clueId` 欄位
4. ✅ 已完成：為所有 moment-configs 添加 `seedMap` 欄位
5. ✅ 已完成：為對應的 moment-configs 添加 `entryOverrides` 欄位

**狀態**：✅ 所有項目已完成

---

## 總結

整體而言，所有 moment-configs 文件的**結構完整性**和**內容質量**都很好 ✅

主要需要補強的是：
1. 添加缺失的配置欄位（clueId、seedMap、entryOverrides）
2. 修正時刻 2 的 target 不一致問題

✅ 所有 P0 項目已完成，配置欄位已完整，可以進行開發。

