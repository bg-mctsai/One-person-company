# 對話機制設計

## 核心機制

### 對話目標
透過與NPC對話，在限定回合數內達成目標情緒狀態，改變事件走向。

### 情緒系統

#### 情緒類型

**正面情緒**（達成目標）：
- **好感**：對玩家產生好感，願意接納
- **欣賞**：認可玩家的能力或價值
- **尊重**：開始尊重玩家的意見和存在
- **愧疚**：意識到自己的錯誤，感到抱歉
- **認同**：認同玩家的觀點或行為

**負面情緒**（可能轉化為正面）：
- **憤怒**：被激怒，但可能因此正視問題
- **震驚**：被玩家的話語震撼，開始思考
- **崩潰**：心理防線被擊破，可能因此改變
- **慌張**：感到不安，可能因此讓步

**中性情緒**（初始狀態）：
- **冷漠**：對玩家漠不關心（需要改變的初始狀態）
- **困惑**：不理解玩家的意圖

### 對話回合限制

- **簡單挑戰**：3句對話內達成目標
- **中等挑戰**：4句對話內達成目標
- **困難挑戰**：5句對話內達成目標

### 對話流程

1. **場景呈現**
   - 顯示當前情境
   - 顯示NPC角色
   - 顯示NPC初始情緒狀態

2. **NPC初始對話**
   - NPC說出第一句話
   - 顯示初始情緒（通常是冷漠）

3. **玩家選擇**
   - 從3-4個選項中選擇回應
   - 每個選項會導致不同的情緒變化

4. **情緒變化**
   - 根據玩家選擇，NPC情緒發生變化
   - 顯示情緒變化動畫/效果

5. **繼續對話**
   - 根據情緒變化，NPC繼續回應
   - 玩家再次選擇

6. **達成目標**
   - 達到目標情緒狀態即完成挑戰
   - 顯示成功動畫和改變結果

### 對話選項設計原則

#### 1. 積極對抗型
- **特點**：直接表達需求，強硬態度
- **效果**：可能獲得尊重，也可能引起憤怒
- **適用場景**：需要打破現狀的挑戰
- **範例**：「我也是這個家的一份子，為什麼每次都要我自己拿碗？」

#### 2. 溫和堅持型
- **特點**：用溫和但堅定的方式表達
- **效果**：更容易獲得認同和尊重
- **適用場景**：需要建立關係的挑戰
- **範例**：「我想和大家一起吃飯，可以幫我準備碗筷嗎？」

#### 3. 情感訴求型
- **特點**：用情感打動對方
- **效果**：可能獲得愧疚或認同
- **適用場景**：需要喚起同理心的挑戰
- **範例**：「我知道這對你們來說不算什麼，但對我來說很重要。」

#### 4. 順從消極型
- **特點**：順從對方，不表達需求
- **效果**：不會改變現狀，導致失敗
- **適用場景**：無（這是錯誤選項）
- **範例**：「沒關係，我自己來就好。」

### 情緒轉化路徑

#### 常見轉化路徑

1. **冷漠 → 震驚 → 愧疚 → 尊重**
   - 適用：家庭關係類挑戰
   - 方法：讓對方意識到自己的錯誤

2. **冷漠 → 憤怒 → 震驚 → 尊重**
   - 適用：職場挫敗類挑戰
   - 方法：強硬對抗，讓對方正視問題

3. **冷漠 → 困惑 → 認同 → 欣賞**
   - 適用：需要建立關係的挑戰
   - 方法：溫和堅持，逐步建立認同

4. **冷漠 → 震驚 → 崩潰 → 改變**
   - 適用：需要徹底改變的挑戰
   - 方法：擊破心理防線，徹底改變

### 成功判定

#### 達成條件
- 在限定回合數內完成
- 達到目標情緒狀態
- 改變事件走向

#### 失敗條件
- 超過對話回合限制
- NPC情緒惡化且無法挽回
- 未能達成目標情緒

### 挑戰難度分級

#### 簡單挑戰（3回合）
- 目標情緒：從冷漠 → 認同/尊重
- 轉化路徑：1-2步即可達成
- 範例：挑戰1（晚餐桌上的空位）

#### 中等挑戰（4回合）
- 目標情緒：從冷漠 → 欣賞/愧疚
- 轉化路徑：2-3步才能達成
- 範例：挑戰2（被裁掉的家庭合照）、挑戰3（被忽視的成就）

#### 困難挑戰（5回合）
- 目標情緒：從冷漠 → 崩潰/徹底改變
- 轉化路徑：需要3-4步，可能經歷負面情緒
- 範例：挑戰10（被推卸的黑鍋）、挑戰14（被送給別人的禮物）

### 對話範例

#### 範例1：挑戰1 - 晚餐桌上的空位

**回合1**：
- **母親**：「啊，忘了你也在家。你自己去廚房拿碗吧。」（冷漠）
- **玩家選項**：
  1. 「媽，我也是這個家的一份子，為什麼每次都要我自己拿碗？」（積極對抗）
  2. 「沒關係，我自己來就好。」（順從消極）
  3. 「我想和大家一起吃飯，可以幫我準備碗筷嗎？」（溫和堅持）

**回合2**（選擇1）：
- **母親**：「你...你說得對，我這就去準備。」（震驚 → 愧疚）
- **成功**：達成目標情緒「愧疚」，挑戰完成

**回合2**（選擇3）：
- **母親**：「當然可以，我這就去準備。」（困惑 → 認同）
- **成功**：達成目標情緒「認同」，挑戰完成

#### 範例2：挑戰7 - 被改名的功勞

**回合1**：
- **主管**：「這個專案是XXX完成的。」（冷漠，說錯名字）
- **玩家選項**：
  1. 「主管，這個專案是我完成的，不是XXX。」（積極對抗）
  2. 「...」（沉默，不會改變）
  3. 「我可以補充說明一下這個專案的細節嗎？」（溫和堅持）

**回合2**（選擇1）：
- **主管**：「什麼？你說什麼？」（震驚）
- **玩家選項**：
  1. 「這個專案的所有文件都在我這裡，我可以證明。」（繼續對抗）
  2. 「可能是我記錯了，對不起。」（退縮，失敗）

**回合3**（選擇1）：
- **主管**：「...讓我看看文件。」（震驚 → 愧疚）
- **成功**：達成目標情緒「愧疚」，挑戰完成

### AI對話系統整合

#### 動態生成機制
- 根據玩家選擇和NPC當前情緒，動態生成NPC回應
- 確保回應符合NPC性格和當前情緒狀態

#### 情緒判定系統
- 實時追蹤NPC情緒狀態
- 根據對話內容自動調整情緒值
- 達到目標情緒閾值即判定成功

#### 成功判定系統
- 自動判定是否達成目標情緒
- 判定是否在回合限制內完成
- 判定事件走向是否改變

### 視覺呈現

#### 情緒顯示
- **情緒圖標**：顯示NPC當前情緒（愛心=好感，火焰=憤怒等）
- **情緒條**：顯示情緒變化過程
- **表情變化**：NPC表情隨情緒變化

#### 對話介面
- **對話框**：顯示NPC和玩家的對話
- **選項按鈕**：顯示玩家可選的回應
- **回合計數器**：顯示剩餘對話回合數

#### 成功/失敗動畫
- **成功**：顯示情緒轉化動畫，NPC態度改變
- **失敗**：顯示時間到或情緒惡化動畫

